# FilmorateDbArchitecture

![alt text](https://github.com/Tulpanchik2906/FilmorateDbArchitecture/blob/main/QuickDBD-export-filmorate.png)

## Основные запросы к БД
- Получить список всех фильмов
``` sql
SELECT * FROM FILMS;
```

- Получить фильм по id
``` sql
SELECT * FROM FILMS
WHERE ID = <film_id>;
```

- Получить список всех пользователей
``` sql
SELECT * FROM USERS;
```

- Получить пользователя по Id
``` sql
SELECT * FROM USERS
WHERE ID = <user_id>;
```

- 10 Самых популярных фильмов
``` sql
SELECT FILMS.NAME, COUNT(LIKES.USER_ID)
FROM FILMS
LEFT JOIN LIKES ON
FILMS.ID = LIKES.FILM_ID
GROUP BY FILMS.ID
ORDER BY COUNT(LIKES.USER_ID) DESC
LIMIT 10;
```

- Получить список друзей пользователя
``` sql
SELECT USERS.* FROM FRIENDSHIP 
JOIN USERS ON
USERS.ID = FRIENDSHIP.ACCEPTOR_ID 
WHERE FRIENDSHIP.INITIATOR_ID = <friend_id_1> AND FRIENDSHIP.STATUS = TRUE 
UNION 
SELECT USERS.* FROM FRIENDSHIP 
JOIN USERS ON
USERS.ID = FRIENDSHIP.INITIATOR_ID 
WHERE FRIENDSHIP.ACCEPTOR_ID = 2 AND FRIENDSHIP.STATUS = TRUE 
```
- Получить список общих друзей
``` sql
SELECT USERS.* FROM FRIENDSHIP 
JOIN USERS ON
USERS.ID = FRIENDSHIP.ACCEPTOR_ID 
WHERE FRIENDSHIP.INITIATOR_ID = 2 AND FRIENDSHIP.STATUS = TRUE 
AND FRIENDSHIP.ACCEPTOR_ID IN  
	(SELECT ACCEPTOR_ID FROM FRIENDSHIP
	 WHERE INITIATOR_ID = 3 AND FRIENDSHIP.STATUS = TRUE
	 UNION
	 SELECT INITIATOR_ID FROM FRIENDSHIP
	 WHERE ACCEPTOR_ID = 3 AND FRIENDSHIP.STATUS = TRUE)
UNION 
SELECT USERS.* FROM FRIENDSHIP 
JOIN USERS ON
USERS.ID = FRIENDSHIP.INITIATOR_ID 
WHERE FRIENDSHIP.ACCEPTOR_ID  = 2 AND FRIENDSHIP.STATUS = TRUE 
AND FRIENDSHIP.INITIATOR_ID  IN  
	(SELECT ACCEPTOR_ID FROM FRIENDSHIP
	 WHERE INITIATOR_ID = 3 AND FRIENDSHIP.STATUS = TRUE
	 UNION
	 SELECT INITIATOR_ID FROM FRIENDSHIP
	 WHERE ACCEPTOR_ID = 3 AND FRIENDSHIP.STATUS = TRUE)
```
